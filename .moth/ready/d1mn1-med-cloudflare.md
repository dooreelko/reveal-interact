implement cloudflare version of the architecture
